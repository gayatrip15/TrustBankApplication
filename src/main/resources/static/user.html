<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>User Details</title>
<link href="https://unicons.iconscout.com/release/v4.0.8/css/line.css"
	rel="stylesheet">
<style>
* {
	margin: 0;
	padding: 0;
	box-sizing: border-box;
	font-family: "Segoe UI", sans-serif;
}

body {
	background: #f6f8fc;
	color: #333;
}

.dashboard {
	display: flex;
	height: 100vh;
}

.sidebar {
	width: 260px;
	background: #fff;
	border-right: 1px solid #e5e5e5;
	padding: 20px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.logo {
	font-size: 18px;
	color: #6a1b9a;
	margin-bottom: 20px;
}

.menu {
	list-style: none;
}

.menu li {
	padding: 10px;
	display: flex;
	align-items: center;
	gap: 10px;
	cursor: pointer;
	border-radius: 8px;
	color: #555;
	margin-bottom: 10px;
	transition: 0.3s;
}

.menu li:hover {
	background: #f2f2f2;
	color: #6a1b9a;
}

.section-title {
	margin: 15px 0 5px 5px;
	font-size: 12px;
	color: #888;
}

.help-box {
	background: #ffe0b2;
	padding: 15px;
	border-radius: 10px;
	text-align: center;
}

.help-box button {
	margin-top: 10px;
	padding: 8px 12px;
	border: none;
	background: #ef6c00;
	color: white;
	border-radius: 6px;
	cursor: pointer;
}

.main {
	flex: 1;
	display: flex;
	flex-direction: column;
	overflow-y: auto;
}

.navbar {
	background: linear-gradient(90deg, #673ab7, #512da8, #1976d2);
	padding: 15px 30px;
	display: flex;
	justify-content: flex-end;;
	align-items: center;
	color: white;
}

.nav-links {
	display: flex;
	align-items: center;
	gap: 20px;
}

.nav-links a {
	color: white;
	text-decoration: none;
}

.profile {
	display: flex;
	align-items: center;
	gap: 10px;
}

.profile img {
	border-radius: 50%;
}

.cards {
	display: grid;
	grid-template-columns: repeat(3, 1fr);
	gap: 20px;
	padding: 20px 30px;
}

.card {
	padding: 20px;
	border-radius: 15px;
	color: #fff;
}

.card.green {
	background: #9ccc65;
}

.card.orange {
	background: #ff7043;
}

.card.blue {
	background: #26c6da;
}

.transactions {
	display: grid;
	grid-template-columns: 2fr 1fr;
	gap: 20px;
	padding: 20px 30px 40px;
}

.transactions ul {
	list-style: none;
}

.transactions li {
	background: #fff;
	padding: 12px;
	margin-bottom: 10px;
	border-radius: 10px;
	display: flex;
	justify-content: space-between;
	align-items: center;
	font-size: 14px;
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.transactions li i {
	margin-right: 10px;
	color: #6a1b9a;
}

.amount {
	font-weight: bold;
}

.icon {
	display: inline-block;
	width: 12px;
	height: 12px;
	border-radius: 50%;
	margin-right: 8px;
}

.icon.purple {
	background: #7e57c2;
}

.icon.red {
	background: #ef5350;
}

.icon.yellow {
	background: #ffca28;
}

.icon.orange {
	background: #fb8c00;
}
</style>
</head>
<body>
	<div class="dashboard">

		<aside class="sidebar">
			<div
				style="display: flex; align-items: center; justify-content: space-between;">
				<h2 class="logo">Trust Bank</h2>
			</div>

			<nav>
				<ul class="menu">

					<li><a href="user.html"
						style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 8px;">
							<i class="uil uil-estate"></i> Dashboard
					</a></li>
					<li><a href="userfundtransfer.html"
						style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 8px;">
							<i class="uil uil-transaction"></i> Transfer Amount
					</a></li>
					<li><a id="statement-link"
						style="text-decoration: none; color: inherit;"> <i
							class="uil uil-file-alt"></i> Statement
					</a></li>
					<li><a href="loan.html"
						style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 8px;">
							<i class="uil uil-invoice"></i> Loan Section
					</a></li>
					
				</ul>

				<ul class="menu">

					<li><a href="about.html"
						style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 8px;">
							<i class="uil uil-invoice"></i> About
					</a></li>


					<li><a href="index.html"
						style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 8px;">
							<i class="uil uil-signout"></i> Logout
					</a></li>
				</ul>
			</nav>

			<div class="help-box">
  <h4>Help Center</h4>
  <p>
    Having trouble?<br>Please contact us for more questions.
  </p>
  <a href="help.html">
    <button>Go To Help Center</button>
  </a>
</div>

		</aside>


		<main class="main">

			<header class="navbar">

				<div class="nav-links">
					<div class="profile">
						<span>Hi, User</span>
					</div>
				</div>
			</header>


			<section class="cards">
				<div class="card green">
					<p class="fullname">Full Name</p>
					<h3 class="account-no">Account No</h3>
					<p class="IFSCcode">IFSC Code</p>
					<p class="account-type">Account Type</p>
				</div>

				<div class="card orange">
					<p class="address">Address</p>
					<p class="phoneNumber">Phone Number</p>
					<p class="gender">Gender</p>
					<p class="email">Email</p>
				</div>

				<div class="card blue">
					<h2 class="balance">Balance</h2>
				</div>
			</section>


			<section class="transactions">
				<div class="latest">
					<h3>Latest Transactions</h3>
					<ul class="tx-list"></ul>
				</div>
			</section>
		</main>
	</div>

	<script>
    const params = new URLSearchParams(window.location.search);
    const userId = params.get("userId");
    document.getElementById('statement-link').href = `statement.html?userId=${userId}`;
  //  document.getElementById('statement-link').href = `user.html?userId=${userId}`;

    if (userId) {
      fetch(`http://localhost:8080/get-user/${userId}`)
        .then(res => res.json())
        .then(user => {
          console.log("User data from API:", user); 
          if (!user) {
            alert("User not found");
            return;
          }

         
          document.querySelector(".profile span").textContent = `Hi, ${user.firstname}`;

          
          document.querySelector(".fullname").textContent = `Name: ${user.firstname} ${user.lastname}`;
          document.querySelector(".account-no").textContent = `Account no: ${user.accountNo || "N/A"}`;
          document.querySelector(".IFSCcode").textContent = `IFSC code: ${user.ifscCode || "N/A"}`;
          document.querySelector(".account-type").textContent = `Account Type: ${user.accountType || "N/A"}`;

         
          document.querySelector(".address").textContent = `Address: ${user.address || "N/A"}`;
          document.querySelector(".phoneNumber").textContent = `Phone: ${user.phoneNumber || "N/A"}`;
          document.querySelector(".gender").textContent = `Gender: ${user.gender || "N/A"}`;
          document.querySelector(".email").textContent = `Email: ${user.email || "N/A"}`;

         
          document.querySelector(".balance").textContent = `Balance: ₹ ${user.balance || 0}`;

        
          loadTransactions(user.userId);   //for latest transaction
        })
        .catch(err => console.error("Error fetching user:", err));
    }

  
    function loadTransactions(userId) {
      let list = document.querySelector(".tx-list");
      list.innerHTML = "<li>Loading transactions...</li>";

      fetch(`http://localhost:8080/get-transactions/${userId}`)
        .then(res => res.json())
        .then(transactions => {
          console.log("Transactions from API:", transactions); 

          list.innerHTML = "";

         
          if (!Array.isArray(transactions)) {
            transactions = [transactions];
          }

          if (transactions.length > 0) {
            
            transactions.sort((a, b) => new Date(a.date) - new Date(b.date));

           
            const lastFive = transactions.slice(-5);

            lastFive.forEach(tx => {
              const li = document.createElement("li");
              li.innerHTML = `
                <i class="uil uil-money-withdrawal"></i> 
                ${tx.description} <span>₹ ${tx.amount}</span>
              `;
              list.appendChild(li);
            });
          } else {
            list.innerHTML = "<li>No transactions available</li>";
          }
        })
        .catch(err => {
          console.error("Error fetching transactions:", err);
          list.innerHTML = "<li>Error loading transactions</li>";
        });
    }
  </script>
</body>
</html>
