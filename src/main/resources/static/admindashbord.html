<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>User Management</title>
<link href="https://unicons.iconscout.com/release/v4.0.8/css/line.css" rel="stylesheet">
<style>
body {
	font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
	margin: 0;
	padding: 0;
	background: #eef2f7;
}

.navbar {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 15px 25px;
	background: linear-gradient(90deg, #1e3c72, #2a5298);
	color: white;
	box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

.navbar h1 {
	font-size: 24px;
}

.navbar button, .navbar a {
	padding: 8px 15px;
	border-radius: 5px;
	border: none;
	font-weight: bold;
	cursor: pointer;
	text-decoration: none;
	color: white;
	margin-left: 10px;
	transition: 0.3s;
}

.navbar button {
	background: #ff9800;
}

.navbar button:hover {
	background: #e68900;
}

.navbar a {
	background: #f44336;
}

.navbar a:hover {
	background: #d32f2f;
}

.container {
	padding: 25px;
	max-width: 1400px;
	margin: 0 auto;
}

.header-section {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 20px;
	flex-wrap: wrap;
}

.header-section h2 {
	margin: 0;
	color: #1e3c72;
}

.search-bar {
	display: flex;
	justify-content: flex-end;
	margin-bottom: 0;
}

.search-bar input {
	padding: 8px 12px;
	width: 250px;
	border-radius: 6px;
	border: 1px solid #ccc;
	font-size: 14px;
	transition: all 0.3s;
}

.search-bar input:focus {
	border-color: #007bff;
	box-shadow: 0 0 5px rgba(0, 123, 255, 0.3);
	outline: none;
}

.table-wrapper {
	overflow-x: auto;
}

table {
	width: 100%;
	border-collapse: collapse;
	background: white;
	border-radius: 10px;
	overflow: hidden;
	box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

th, td {
	padding: 12px 15px;
	text-align: left;
}

th {
	background: #1e3c72;
	color: white;
}

tr:nth-child(even) {
	background: #f9fbfd;
}

tr:hover {
	background: #f0f4f8;
}

.btn {
	padding: 6px 12px;
	border: none;
	border-radius: 5px;
	cursor: pointer;
	color: white;
	font-weight: bold;
	transition: 0.3s;
}

.btn-update { background: #4CAF50; }
.btn-update:hover { background: #45a049; }

.btn-delete { background: #f44336; }
.btn-delete:hover { background: #d32f2f; }

.btn-details { background: #007bff; }
.btn-details:hover { background: #0056b3; }

.btn-transfer { background: #FF9800; }
.btn-transfer:hover { background: #e68900; }

.btn-Withdrawal { background: #9C27B0; }
.btn-Withdrawal:hover { background: #7b1fa2; }

.btn-balance { background: #00BCD4; }
.btn-balance:hover { background: #00acc1; }


@media (max-width: 768px) {
	.header-section {
		flex-direction: column;
		align-items: center;
		text-align: center;
	}
	.search-bar {
		margin-top: 10px;
		justify-content: center;
	}
	table, table th, table td {
		display: block;
		width: 100%;
	}
	table th {
		display: none;
	}
	table td {
		padding-left: 50%;
		position: relative;
		text-align: right;
	}
	table td::before {
		content: attr(data-label);
		position: absolute;
		left: 15px;
		width: 45%;
		text-align: left;
		font-weight: bold;
		color: #555;
	}
	tr {
		margin-bottom: 15px;
		border-bottom: 2px solid #eee;
	}
}
</style>
</head>
<body>

<div class="navbar">
	<button onclick="window.location.href='admin.html'">â¬… Back</button>
	<h1>TrustBank</h1>
	<div>
		<button onclick="window.location.href='createAccount.html'">Create New Account</button>
		<a href="index.html">Logout</a>
	</div>
</div>

<div class="container">
	<div class="header-section">
		<h2>User Management</h2>
		<div class="search-bar">
			<input type="text" id="userSearch" placeholder="Search by name or account number">
		</div>
	</div>

	<div class="table-wrapper">
		<table id="userTable">
			<thead>
				<tr>
					<th>User ID</th>
					<th>Name</th>
					<th>Account No</th>
					<th>Update</th>
					<th>Delete</th>
					<th>All Details</th>
					<th>Money Transfer</th>
					<th>Withdrawal</th>
					<th>Add Balance</th>
				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
	</div>
</div>

<script>

function loadUsers() {
    fetch('/user-list') 
        .then(res => res.json())
        .then(users => {
            const tbody = document.querySelector("#userTable tbody");
            tbody.innerHTML = "";

            users.forEach(user => {
                const tr = document.createElement("tr");
                tr.innerHTML = `
                    <td data-label="User ID">${user.userId}</td>
                    <td data-label="Name">${user.firstname} ${user.lastname}</td>
                    <td data-label="Account No">${user.accountNo}</td>
                    <td data-label="Update"><button class="btn btn-update" onclick="updateUser(${user.userId})">Update</button></td>
                    <td data-label="Delete"><button class="btn btn-delete" onclick="deleteUser(${user.userId})">Delete</button></td>
                    <td data-label="All Details"><button class="btn btn-details" onclick="showDetails(${user.userId})">All Details</button></td>
                    <td data-label="Money Transfer"><button class="btn btn-transfer" onclick="fundtransfer(${user.userId})">Money Transfer</button></td>
                    <td data-label="Withdrawal"><button class="btn btn-Withdrawal" onclick="Withdrawal(${user.userId})">Withdrawal</button></td>
                    <td data-label="Add Balance"><button class="btn btn-balance" onclick="addbalance(${user.userId})">Add Balance</button></td>
                `;
                tbody.appendChild(tr);
            });
        })
        .catch(err => console.error("Error fetching users:", err));
}

function deleteUser(userId) {
    if (confirm("Are you sure you want to delete this user?")) {
        fetch(`/delete1/${userId}`, { method: 'DELETE' })
            .then(res => res.text())
            .then(msg => { alert(msg); loadUsers(); })
            .catch(err => console.error("Error deleting user:", err));
    }
}

function showDetails(userId) { window.location.href = `user.html?userId=${userId}`; }
function updateUser(userId) { window.location.href = `userupdatebyadmin.html?userId=${userId}`; }
function fundtransfer(userId) { window.location.href = `userfundtransfer.html?userId=${userId}`; }
function Withdrawal(userId) { window.location.href = `withdraw.html?userId=${userId}`; }
function addbalance(userId) { window.location.href = `addbalance.html?userId=${userId}`; }


 document.getElementById("userSearch").addEventListener("keyup", function() {
    const filter = this.value.toLowerCase();
    const rows = document.querySelectorAll("#userTable tbody tr");
    rows.forEach(row => {
        const name = row.cells[1].textContent.toLowerCase();
        const account = row.cells[2].textContent.toLowerCase();
        row.style.display = (name.includes(filter) || account.includes(filter)) ? "" : "none";
    });
});

window.onload = loadUsers;
</script>

</body>
</html>
